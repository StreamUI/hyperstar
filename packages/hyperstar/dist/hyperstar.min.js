var{defineProperty:Oq,getOwnPropertyNames:$J,getOwnPropertyDescriptor:jJ}=Object,GJ=Object.prototype.hasOwnProperty;var bq=new WeakMap,YJ=(q)=>{var J=bq.get(q),K;if(J)return J;if(J=Oq({},"__esModule",{value:!0}),q&&typeof q==="object"||typeof q==="function")$J(q).map((Q)=>!GJ.call(J,Q)&&Oq(J,Q,{get:()=>q[Q],enumerable:!(K=jJ(q,Q))||K.enumerable}));return bq.set(q,J),J};var zJ=(q,J)=>{for(var K in J)Oq(q,K,{get:J[K],enumerable:!0,configurable:!0,set:(Q)=>J[K]=()=>Q})};var FJ=(q,J)=>()=>(q&&(J=q(q=0)),J);var vq={};zJ(vq,{untracked:()=>Lq,signal:()=>_q,effect:()=>Zq,computed:()=>UJ,batch:()=>g,Signal:()=>S,Effect:()=>x,Computed:()=>C});function Qq(){if(!(h>1)){var q,J=!1;while(l!==void 0){var K=l;l=void 0,Dq++;while(K!==void 0){var Q=K.o;if(K.o=void 0,K.f&=-3,!(8&K.f)&&fq(K))try{K.c()}catch(G){if(!J)q=G,J=!0}K=Q}}if(Dq=0,h--,J)throw q}else h--}function g(q){if(h>0)return q();h++;try{return q()}finally{Qq()}}function Lq(q){var J=k;k=void 0;try{return q()}finally{k=J}}function Nq(q){if(k!==void 0){var J=q.n;if(J===void 0||J.t!==k){if(J={i:0,S:q,p:k.s,n:void 0,t:k,e:void 0,x:void 0,r:J},k.s!==void 0)k.s.n=J;if(k.s=J,q.n=J,32&k.f)q.S(J);return J}else if(J.i===-1){if(J.i=0,J.n!==void 0){if(J.n.p=J.p,J.p!==void 0)J.p.n=J.n;J.p=k.s,J.n=void 0,k.s.n=J,k.s=J}return J}}}function S(q,J){this.v=q,this.i=0,this.n=void 0,this.t=void 0,this.W=J==null?void 0:J.watched,this.Z=J==null?void 0:J.unwatched,this.name=J==null?void 0:J.name}function _q(q,J){return new S(q,J)}function fq(q){for(var J=q.s;J!==void 0;J=J.n)if(J.S.i!==J.i||!J.S.h()||J.S.i!==J.i)return!0;return!1}function hq(q){for(var J=q.s;J!==void 0;J=J.n){var K=J.S.n;if(K!==void 0)J.r=K;if(J.S.n=J,J.i=-1,J.n===void 0){q.s=J;break}}}function Cq(q){var J=q.s,K=void 0;while(J!==void 0){var Q=J.p;if(J.i===-1){if(J.S.U(J),Q!==void 0)Q.n=J.n;if(J.n!==void 0)J.n.p=Q}else K=J;if(J.S.n=J.r,J.r!==void 0)J.r=void 0;J=Q}q.s=K}function C(q,J){S.call(this,void 0),this.x=q,this.s=void 0,this.g=Kq-1,this.f=4,this.W=J==null?void 0:J.watched,this.Z=J==null?void 0:J.unwatched,this.name=J==null?void 0:J.name}function UJ(q,J){return new C(q,J)}function wq(q){var J=q.u;if(q.u=void 0,typeof J=="function"){h++;var K=k;k=void 0;try{J()}catch(Q){throw q.f&=-2,q.f|=8,Bq(q),Q}finally{k=K,Qq()}}}function Bq(q){for(var J=q.s;J!==void 0;J=J.n)J.S.U(J);q.x=void 0,q.s=void 0,wq(q)}function WJ(q){if(k!==this)throw Error("Out-of-order effect");if(Cq(this),k=q,this.f&=-2,8&this.f)Bq(this);Qq()}function x(q,J){this.x=q,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=J==null?void 0:J.name}function Zq(q,J){var K=new x(q,J);try{K.c()}catch(G){throw K.d(),G}var Q=K.d.bind(K);return Q[Symbol.dispose]=Q,Q}var XJ,k=void 0,l=void 0,h=0,Dq=0,Kq=0;var kq=FJ(()=>{XJ=Symbol.for("preact-signals");S.prototype.brand=XJ;S.prototype.h=function(){return!0};S.prototype.S=function(q){var J=this,K=this.t;if(K!==q&&q.e===void 0)if(q.x=K,this.t=q,K!==void 0)K.e=q;else Lq(function(){var Q;(Q=J.W)==null||Q.call(J)})};S.prototype.U=function(q){var J=this;if(this.t!==void 0){var{e:K,x:Q}=q;if(K!==void 0)K.x=Q,q.e=void 0;if(Q!==void 0)Q.e=K,q.x=void 0;if(q===this.t){if(this.t=Q,Q===void 0)Lq(function(){var G;(G=J.Z)==null||G.call(J)})}}};S.prototype.subscribe=function(q){var J=this;return Zq(function(){var K=J.value,Q=k;k=void 0;try{q(K)}finally{k=Q}},{name:"sub"})};S.prototype.valueOf=function(){return this.value};S.prototype.toString=function(){return this.value+""};S.prototype.toJSON=function(){return this.value};S.prototype.peek=function(){var q=k;k=void 0;try{return this.value}finally{k=q}};Object.defineProperty(S.prototype,"value",{get:function(){var q=Nq(this);if(q!==void 0)q.i=this.i;return this.v},set:function(q){if(q!==this.v){if(Dq>100)throw Error("Cycle detected");this.v=q,this.i++,Kq++,h++;try{for(var J=this.t;J!==void 0;J=J.x)J.t.N()}finally{Qq()}}}});C.prototype=new S;C.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32)return!0;if(this.f&=-5,this.g===Kq)return!0;if(this.g=Kq,this.f|=1,this.i>0&&!fq(this))return this.f&=-2,!0;var q=k;try{hq(this),k=this;var J=this.x();if(16&this.f||this.v!==J||this.i===0)this.v=J,this.f&=-17,this.i++}catch(K){this.v=K,this.f|=16,this.i++}return k=q,Cq(this),this.f&=-2,!0};C.prototype.S=function(q){if(this.t===void 0){this.f|=36;for(var J=this.s;J!==void 0;J=J.n)J.S.S(J)}S.prototype.S.call(this,q)};C.prototype.U=function(q){if(this.t!==void 0){if(S.prototype.U.call(this,q),this.t===void 0){this.f&=-33;for(var J=this.s;J!==void 0;J=J.n)J.S.U(J)}}};C.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var q=this.t;q!==void 0;q=q.x)q.t.N()}};Object.defineProperty(C.prototype,"value",{get:function(){if(1&this.f)throw Error("Cycle detected");var q=Nq(this);if(this.h(),q!==void 0)q.i=this.i;if(16&this.f)throw this.v;return this.v}});x.prototype.c=function(){var q=this.S();try{if(8&this.f)return;if(this.x===void 0)return;var J=this.x();if(typeof J=="function")this.u=J}finally{q()}};x.prototype.S=function(){if(1&this.f)throw Error("Cycle detected");this.f|=1,this.f&=-9,wq(this),hq(this),h++;var q=k;return k=this,WJ.bind(this,q)};x.prototype.N=function(){if(!(2&this.f))this.f|=2,this.o=l,l=this};x.prototype.d=function(){if(this.f|=8,!(1&this.f))Bq(this)};x.prototype.dispose=function(){this.d()}});kq();var p=new Map,$q=new Map;function w(q,J){if(!p.has(q))p.set(q,_q(J));return p.get(q)}function Eq(q){let J=p.get(q);return J?J.value:void 0}function u(q,J){let K=w(q);K.value=J}function d(q){g(()=>{for(let[J,K]of Object.entries(q))u(J,K)})}function Rq(q){for(let[J,K]of Object.entries(q))if(!p.has(J))w(J,K)}function gq(q,J){$q.get(q)?.();let K=Zq(J);return $q.set(q,K),K}function Vq(){let q={};for(let[J,K]of p)q[J]=K.value;return q}function OJ(){for(let q of $q.values())q();$q.clear(),p.clear()}var xq=function(){let q=()=>{},J={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:q,afterNodeAdded:q,beforeNodeMorphed:q,afterNodeMorphed:q,beforeNodeRemoved:q,afterNodeRemoved:q,beforeAttributeUpdated:q},head:{style:"merge",shouldPreserve:(L)=>L.getAttribute("im-preserve")==="true",shouldReAppend:(L)=>L.getAttribute("im-re-append")==="true",shouldRemove:q,afterHeadMorphed:q},restoreFocus:!0};function K(L,M,B={}){L=y(L);let R=f(M),V=H(L,R,B),U=G(V,()=>{return A(V,L,R,(j)=>{if(j.morphStyle==="innerHTML")return Y(j,L,R),Array.from(L.childNodes);else return Q(j,L,R)})});return V.pantry.remove(),U}function Q(L,M,B){let R=f(M);return Y(L,R,B,M,M.nextSibling),Array.from(R.childNodes)}function G(L,M){if(!L.config.restoreFocus)return M();let B=document.activeElement;if(!(B instanceof HTMLInputElement||B instanceof HTMLTextAreaElement))return M();let{id:R,selectionStart:V,selectionEnd:U}=B,j=M();if(R&&R!==document.activeElement?.getAttribute("id"))B=L.target.querySelector(`[id="${R}"]`),B?.focus();if(B&&!B.selectionEnd&&U)B.setSelectionRange(V,U);return j}let Y=function(){function L($,Z,F,z=null,W=null){if(Z instanceof HTMLTemplateElement&&F instanceof HTMLTemplateElement)Z=Z.content,F=F.content;z||=Z.firstChild;for(let O of F.childNodes){if(z&&z!=W){let T=B($,O,z,W);if(T){if(T!==z)V($,z,T);D(T,O,$),z=T.nextSibling;continue}}if(O instanceof Element){let T=O.getAttribute("id");if($.persistentIds.has(T)){let b=U(Z,T,z,$);D(b,O,$),z=b.nextSibling;continue}}let _=M(Z,O,z,$);if(_)z=_.nextSibling}while(z&&z!=W){let O=z;z=z.nextSibling,R($,O)}}function M($,Z,F,z){if(z.callbacks.beforeNodeAdded(Z)===!1)return null;if(z.idMap.has(Z)){let W=document.createElement(Z.tagName);return $.insertBefore(W,F),D(W,Z,z),z.callbacks.afterNodeAdded(W),W}else{let W=document.importNode(Z,!0);return $.insertBefore(W,F),z.callbacks.afterNodeAdded(W),W}}let B=function(){function $(z,W,O,_){let T=null,b=W.nextSibling,Pq=0,P=O;while(P&&P!=_){if(F(P,W)){if(Z(z,P,W))return P;if(T===null){if(!z.idMap.has(P))T=P}}if(T===null&&b&&F(P,b)){if(Pq++,b=b.nextSibling,Pq>=2)T=void 0}if(z.activeElementAndParents.includes(P))break;P=P.nextSibling}return T||null}function Z(z,W,O){let _=z.idMap.get(W),T=z.idMap.get(O);if(!T||!_)return!1;for(let b of _)if(T.has(b))return!0;return!1}function F(z,W){let O=z,_=W;return O.nodeType===_.nodeType&&O.tagName===_.tagName&&(!O.getAttribute?.("id")||O.getAttribute?.("id")===_.getAttribute?.("id"))}return $}();function R($,Z){if($.idMap.has(Z))X($.pantry,Z,null);else{if($.callbacks.beforeNodeRemoved(Z)===!1)return;Z.parentNode?.removeChild(Z),$.callbacks.afterNodeRemoved(Z)}}function V($,Z,F){let z=Z;while(z&&z!==F){let W=z;z=z.nextSibling,R($,W)}return z}function U($,Z,F,z){let W=z.target.getAttribute?.("id")===Z&&z.target||z.target.querySelector(`[id="${Z}"]`)||z.pantry.querySelector(`[id="${Z}"]`);return j(W,z),X($,W,F),W}function j($,Z){let F=$.getAttribute("id");while($=$.parentNode){let z=Z.idMap.get($);if(z){if(z.delete(F),!z.size)Z.idMap.delete($)}}}function X($,Z,F){if($.moveBefore)try{$.moveBefore(Z,F)}catch(z){$.insertBefore(Z,F)}else $.insertBefore(Z,F)}return L}(),D=function(){function L(j,X,$){if($.ignoreActive&&j===document.activeElement)return null;if($.callbacks.beforeNodeMorphed(j,X)===!1)return j;if(j instanceof HTMLHeadElement&&$.head.ignore);else if(j instanceof HTMLHeadElement&&$.head.style!=="morph")I(j,X,$);else if(M(j,X,$),!U(j,$))Y($,j,X);return $.callbacks.afterNodeMorphed(j,X),j}function M(j,X,$){let Z=X.nodeType;if(Z===1){let F=j,z=X,W=F.attributes,O=z.attributes;for(let _ of O){if(V(_.name,F,"update",$))continue;if(F.getAttribute(_.name)!==_.value)F.setAttribute(_.name,_.value)}for(let _=W.length-1;0<=_;_--){let T=W[_];if(!T)continue;if(!z.hasAttribute(T.name)){if(V(T.name,F,"remove",$))continue;F.removeAttribute(T.name)}}if(!U(F,$))B(F,z,$)}if(Z===8||Z===3){if(j.nodeValue!==X.nodeValue)j.nodeValue=X.nodeValue}}function B(j,X,$){if(j instanceof HTMLInputElement&&X instanceof HTMLInputElement&&X.type!=="file"){let Z=X.value,F=j.value;if(R(j,X,"checked",$),R(j,X,"disabled",$),!X.hasAttribute("value")){if(!V("value",j,"remove",$))j.value="",j.removeAttribute("value")}else if(F!==Z){if(!V("value",j,"update",$))j.setAttribute("value",Z),j.value=Z}}else if(j instanceof HTMLOptionElement&&X instanceof HTMLOptionElement)R(j,X,"selected",$);else if(j instanceof HTMLTextAreaElement&&X instanceof HTMLTextAreaElement){let Z=X.value,F=j.value;if(V("value",j,"update",$))return;if(Z!==F)j.value=Z;if(j.firstChild&&j.firstChild.nodeValue!==Z)j.firstChild.nodeValue=Z}}function R(j,X,$,Z){let F=X[$],z=j[$];if(F!==z){let W=V($,j,"update",Z);if(!W)j[$]=X[$];if(F){if(!W)j.setAttribute($,"")}else if(!V($,j,"remove",Z))j.removeAttribute($)}}function V(j,X,$,Z){if(j==="value"&&Z.ignoreActiveValue&&X===document.activeElement)return!0;return Z.callbacks.beforeAttributeUpdated(j,X,$)===!1}function U(j,X){return!!X.ignoreActiveValue&&j===document.activeElement&&j!==document.body}return L}();function A(L,M,B,R){if(L.head.block){let V=M.querySelector("head"),U=B.querySelector("head");if(V&&U){let j=I(V,U,L);return Promise.all(j).then(()=>{let X=Object.assign(L,{head:{block:!1,ignore:!0}});return R(X)})}}return R(L)}function I(L,M,B){let R=[],V=[],U=[],j=[],X=new Map;for(let Z of M.children)X.set(Z.outerHTML,Z);for(let Z of L.children){let F=X.has(Z.outerHTML),z=B.head.shouldReAppend(Z),W=B.head.shouldPreserve(Z);if(F||W)if(z)V.push(Z);else X.delete(Z.outerHTML),U.push(Z);else if(B.head.style==="append"){if(z)V.push(Z),j.push(Z)}else if(B.head.shouldRemove(Z)!==!1)V.push(Z)}j.push(...X.values());let $=[];for(let Z of j){let F=document.createRange().createContextualFragment(Z.outerHTML).firstChild;if(B.callbacks.beforeNodeAdded(F)!==!1){if("href"in F&&F.href||"src"in F&&F.src){let z,W=new Promise(function(O){z=O});F.addEventListener("load",function(){z()}),$.push(W)}L.appendChild(F),B.callbacks.afterNodeAdded(F),R.push(F)}}for(let Z of V)if(B.callbacks.beforeNodeRemoved(Z)!==!1)L.removeChild(Z),B.callbacks.afterNodeRemoved(Z);return B.head.afterHeadMorphed(L,{added:R,kept:U,removed:V}),$}let H=function(){function L($,Z,F){let{persistentIds:z,idMap:W}=j($,Z),O=M(F),_=O.morphStyle||"outerHTML";if(!["innerHTML","outerHTML"].includes(_))throw`Do not understand how to morph style ${_}`;return{target:$,newContent:Z,config:O,morphStyle:_,ignoreActive:O.ignoreActive,ignoreActiveValue:O.ignoreActiveValue,restoreFocus:O.restoreFocus,idMap:W,persistentIds:z,pantry:B(),activeElementAndParents:R($),callbacks:O.callbacks,head:O.head}}function M($){let Z=Object.assign({},J);return Object.assign(Z,$),Z.callbacks=Object.assign({},J.callbacks,$.callbacks),Z.head=Object.assign({},J.head,$.head),Z}function B(){let $=document.createElement("div");return $.hidden=!0,document.body.insertAdjacentElement("afterend",$),$}function R($){let Z=[],F=document.activeElement;if(F?.tagName!=="BODY"&&$.contains(F))while(F){if(Z.push(F),F===$)break;F=F.parentElement}return Z}function V($){let Z=Array.from($.querySelectorAll("[id]"));if($.getAttribute?.("id"))Z.push($);return Z}function U($,Z,F,z){for(let W of z){let O=W.getAttribute("id");if(Z.has(O)){let _=W;while(_){let T=$.get(_);if(T==null)T=new Set,$.set(_,T);if(T.add(O),_===F)break;_=_.parentElement}}}}function j($,Z){let F=V($),z=V(Z),W=X(F,z),O=new Map;U(O,W,$,F);let _=Z.__idiomorphRoot||Z;return U(O,W,_,z),{persistentIds:W,idMap:O}}function X($,Z){let F=new Set,z=new Map;for(let{id:O,tagName:_}of $)if(z.has(O))F.add(O);else z.set(O,_);let W=new Set;for(let{id:O,tagName:_}of Z)if(W.has(O))F.add(O);else if(z.get(O)===_)W.add(O);for(let O of F)W.delete(O);return W}return L}(),{normalizeElement:y,normalizeParent:f}=function(){let L=new WeakSet;function M(U){if(U instanceof Document)return U.documentElement;else return U}function B(U){if(U==null)return document.createElement("div");else if(typeof U==="string")return B(V(U));else if(L.has(U))return U;else if(U instanceof Node)if(U.parentNode)return new R(U);else{let j=document.createElement("div");return j.append(U),j}else{let j=document.createElement("div");for(let X of[...U])j.append(X);return j}}class R{constructor(U){this.originalNode=U,this.realParentNode=U.parentNode,this.previousSibling=U.previousSibling,this.nextSibling=U.nextSibling}get childNodes(){let U=[],j=this.previousSibling?this.previousSibling.nextSibling:this.realParentNode.firstChild;while(j&&j!=this.nextSibling)U.push(j),j=j.nextSibling;return U}querySelectorAll(U){return this.childNodes.reduce((j,X)=>{if(X instanceof Element){if(X.matches(U))j.push(X);let $=X.querySelectorAll(U);for(let Z=0;Z<$.length;Z++)j.push($[Z])}return j},[])}insertBefore(U,j){return this.realParentNode.insertBefore(U,j)}moveBefore(U,j){return this.realParentNode.moveBefore(U,j)}get __idiomorphRoot(){return this.originalNode}}function V(U){let j=new DOMParser,X=U.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(X.match(/<\/html>/)||X.match(/<\/head>/)||X.match(/<\/body>/)){let $=j.parseFromString(U,"text/html");if(X.match(/<\/html>/))return L.add($),$;else{let Z=$.firstChild;if(Z)L.add(Z);return Z}}else{let Z=j.parseFromString("<body><template>"+U+"</template></body>","text/html").body.querySelector("template").content;return L.add(Z),Z}}return{normalizeElement:M,normalizeParent:B}}();return{morph:K,defaults:J}}();var s=new WeakMap;function DJ(q,J){let K=s.get(q)||[];K.push(J),s.set(q,K)}function LJ(q){let J=s.get(q);if(J){for(let K of J)try{K()}catch(Q){console.error("Cleanup callback error:",Q)}s.delete(q)}for(let K of q.querySelectorAll("*")){let Q=s.get(K);if(Q){for(let G of Q)try{G()}catch(Y){console.error("Cleanup callback error:",Y)}s.delete(K)}}}function a(q,J,K="outer"){xq.morph(q,J,{morphStyle:K==="outer"?"outerHTML":"innerHTML",ignoreActiveValue:!0,restoreFocus:!0,callbacks:{beforeNodeRemoved(Q){if(Q instanceof Element)LJ(Q);return!0}}})}function _J(q){let J=document.createElement("template");return J.innerHTML=q.trim(),J.content.firstElementChild}var jq=new Map;function pq(q){return q.replace(/\$(?!\$|evt|el|refs|this)(\w+)/g,(J,K)=>{return`signals['${K}'].value`})}function Tq(){return new Proxy({},{get(q,J){return w(J)},set(q,J,K){return u(J,K),!0}})}function uq(q){let J=jq.get(q);if(J)return J;let K=pq(q),Q=Function("signals","$evt","$el","$refs",`
    "use strict";
    try {
      return ${K};
    } catch (e) {
      console.error('Expression error:', e, 'in:', ${JSON.stringify(q)});
      return undefined;
    }
    `);return jq.set(q,Q),Q}function BJ(q){let J=jq.get("stmt:"+q);if(J)return J;let K=pq(q),Q=Function("signals","$evt","$el","$refs","Hyperstar",`
    "use strict";
    try {
      ${K};
    } catch (e) {
      console.error('Statement error:', e, 'in:', ${JSON.stringify(q)});
    }
    `);return jq.set("stmt:"+q,Q),Q}function mq(q,J){let K=uq(q),Q=Tq();return K(Q,J?.evt,J?.el,J?.refs)}function r(q,J){g(()=>{let K=BJ(q),Q=Tq(),G=window.Hyperstar;K(Q,J?.evt,J?.el,J?.refs,G)})}function v(q,J,K){let Q=uq(q),G=Tq(),{effect:Y}=(kq(),YJ(vq));return Y(()=>{let A=Q(G,void 0,K?.el,K?.refs);J(A)})}var t=new WeakMap,n=null;function kJ(){if(!n)n={},document.querySelectorAll("[hs-ref]").forEach((q)=>{let J=q.getAttribute("hs-ref");if(J)n[J]=q});return n}function cq(){n=null}function RJ(q){if(!q.startsWith("hs-on:"))return null;let J=q.slice(6).split("__"),K=J[0],Q={};for(let G=1;G<J.length;G++){let Y=J[G];if(Y==="prevent")Q.prevent=!0;else if(Y==="stop")Q.stop=!0;else if(Y==="once")Q.once=!0;else if(Y==="outside")Q.outside=!0;else if(Y==="capture")Q.capture=!0;else if(Y==="passive")Q.passive=!0;else if(Y==="self")Q.self=!0;else if(Y.startsWith("debounce")){let D=Y.match(/debounce[._]?(\d+)(ms)?/);if(D)Q.debounce=parseInt(D[1],10)}else if(Y.startsWith("throttle")){let D=Y.match(/throttle[._]?(\d+)(ms)?/);if(D)Q.throttle=parseInt(D[1],10)}}return{event:K,modifiers:Q}}function VJ(q,J){let K=null;return(Q)=>{if(K)clearTimeout(K);K=setTimeout(()=>q(Q),J)}}function TJ(q,J){let K=0,Q=null;return(G)=>{let Y=Date.now(),D=J-(Y-K);if(D<=0){if(Q)clearTimeout(Q),Q=null;K=Y,q(G)}else if(!Q)Q=setTimeout(()=>{K=Date.now(),Q=null,q(G)},D)}}function MJ(q,J,K,Q){let G=(H)=>{if(Q.self&&H.target!==q)return;if(Q.prevent)H.preventDefault();if(Q.stop)H.stopPropagation();r(K,{evt:H,el:q,refs:kJ()})};if(Q.debounce)G=VJ(G,Q.debounce);else if(Q.throttle)G=TJ(G,Q.throttle);let Y={capture:Q.capture,passive:Q.passive,once:Q.once},D;if(Q.outside){let H=(y)=>{if(!q.contains(y.target))G(y)};document.addEventListener(J,H,Y),D=()=>document.removeEventListener(J,H,Y)}else q.addEventListener(J,G,Y),D=()=>q.removeEventListener(J,G,Y);if(!t.has(q))t.set(q,new Map);let A=t.get(q),I=`${J}:${K}`;return A.get(I)?.(),A.set(I,D),D}function dq(q){Mq(q);for(let J of q.attributes){let K=RJ(J.name);if(K)MJ(q,K.event,J.value,K.modifiers)}}function Mq(q){let J=t.get(q);if(J){for(let K of J.values())K();J.clear(),t.delete(q)}}var e=new WeakMap;function HJ(q){if(!e.has(q))e.set(q,new Map);return e.get(q)}function m(q,J,K){let Q=HJ(q);Q.get(J)?.(),Q.set(J,K)}function AJ(q){let J=q.getAttribute("hs-show");if(!J)return;let K=q.style.display,Q=v(J,(G)=>{let Y=q;if(G)Y.style.display=K||"";else Y.style.display="none"},{el:q});m(q,"show",Q)}function SJ(q){for(let K of q.attributes)if(K.name.startsWith("hs-class:")){let Q=K.name.slice(9),G=K.value,Y=v(G,(D)=>{if(D)q.classList.add(Q);else q.classList.remove(Q)},{el:q});m(q,`class:${Q}`,Y)}let J=q.getAttribute("hs-class");if(J){let K=v(J,(Q)=>{if(typeof Q==="object"&&Q!==null)for(let[G,Y]of Object.entries(Q))if(Y)q.classList.add(G);else q.classList.remove(G)},{el:q});m(q,"class",K)}}function IJ(q){for(let J of q.attributes)if(J.name.startsWith("hs-attr:")){let K=J.name.slice(8),Q=J.value,G=v(Q,(Y)=>{if(Y===!1||Y===null||Y===void 0)q.removeAttribute(K);else if(Y===!0)q.setAttribute(K,"");else q.setAttribute(K,String(Y))},{el:q});m(q,`attr:${K}`,G)}}function yJ(q){let J=q.getAttribute("hs-text");if(!J)return;let K=v(J,(Q)=>{q.textContent=Q===null||Q===void 0?"":String(Q)},{el:q});m(q,"text",K)}function PJ(q){let J=q.getAttribute("hs-html");if(!J)return;let K=v(J,(Q)=>{q.innerHTML=Q===null||Q===void 0?"":String(Q)},{el:q});m(q,"html",K)}function bJ(q){for(let J of q.attributes)if(J.name.startsWith("hs-style:")){let K=J.name.slice(9),Q=J.value,G=v(Q,(Y)=>{let D=q;if(Y===null||Y===void 0||Y==="")D.style.removeProperty(K);else D.style.setProperty(K,String(Y))},{el:q});m(q,`style:${K}`,G)}}function sq(q){AJ(q),SJ(q),IJ(q),yJ(q),PJ(q),bJ(q)}function aq(q){let J=e.get(q);if(J){for(let K of J.values())K();J.clear(),e.delete(q)}}var qq=new WeakMap;function NJ(q){if(!qq.has(q))qq.set(q,new Map);return qq.get(q)}function fJ(q){if(q instanceof HTMLSelectElement)return"change";if(q instanceof HTMLInputElement){let J=q.type.toLowerCase();if(J==="checkbox"||J==="radio"||J==="range")return"change"}return"input"}function rq(q){if(q instanceof HTMLInputElement){let J=q.type.toLowerCase();if(J==="checkbox")return q.checked;if(J==="radio")return q.checked?q.value:void 0;if(J==="number"||J==="range")return q.valueAsNumber;return q.value}if(q instanceof HTMLTextAreaElement)return q.value;if(q instanceof HTMLSelectElement){if(q.multiple)return Array.from(q.selectedOptions).map((J)=>J.value);return q.value}if(q.hasAttribute("contenteditable"))return q.innerHTML;return q.innerText}function hJ(q,J){if(q instanceof HTMLInputElement){let K=q.type.toLowerCase();if(K==="checkbox"){q.checked=Boolean(J);return}if(K==="radio"){q.checked=q.value===J;return}q.value=J==null?"":String(J);return}if(q instanceof HTMLTextAreaElement){q.value=J==null?"":String(J);return}if(q instanceof HTMLSelectElement){if(q.multiple&&Array.isArray(J))for(let K of q.options)K.selected=J.includes(K.value);else q.value=J==null?"":String(J);return}if(q.hasAttribute("contenteditable")){q.innerHTML=J==null?"":String(J);return}q.innerText=J==null?"":String(J)}function Hq(q,J){let K=w(J),Q=fJ(q),G=()=>{let H=rq(q);if(H!==void 0)u(J,H)};q.addEventListener(Q,G);let Y=`bind_${J}_${Math.random().toString(36).slice(2)}`,D=gq(Y,()=>{let H=K.value,y=rq(q);if(H!==y)hJ(q,H)}),A=NJ(q),I=()=>{q.removeEventListener(Q,G),D()};A.get(`bind:${J}`)?.(),A.set(`bind:${J}`,I)}function iq(q){let J=q.getAttribute("hs-bind");if(J&&J.startsWith("$")){let K=J.slice(1);Hq(q,K);return}for(let K of q.attributes)if(K.name.startsWith("hs-bind:")){let Q=K.name.slice(8);Hq(q,Q)}if(q.hasAttribute("hs-bind")&&!J){let K=q.getAttribute("name");if(K)Hq(q,K)}}function oq(q){let J=qq.get(q);if(J){for(let K of J.values())K();J.clear(),qq.delete(q)}}var i=new WeakSet;function CJ(q){let J=q.getAttribute("hs-signals");if(J)try{let K=JSON.parse(J);Rq(K)}catch(K){console.error("[hyperstar] Failed to parse hs-signals:",K,J)}}function wJ(q){let J=q.getAttribute("hs-init");if(J)r(J,{el:q})}function vJ(q){}function nq(q){for(let J of q.attributes)if(J.name.startsWith("hs-"))return!0;return!1}function Jq(q){if(!nq(q))return;if(i.has(q))return;i.add(q),CJ(q),wJ(q),vJ(q),iq(q),sq(q),dq(q)}function lq(q){Mq(q),aq(q),oq(q),i.delete(q)}function Gq(q){i.delete(q);for(let J of q.querySelectorAll("*"))i.delete(J)}function E(q=document){let J=q instanceof Document?q.body:q;if(!J)return;Jq(J);let K=document.createTreeWalker(J,NodeFilter.SHOW_ELEMENT,{acceptNode(G){if(G instanceof Element&&nq(G))return NodeFilter.FILTER_ACCEPT;return NodeFilter.FILTER_SKIP}}),Q;while(Q=K.nextNode())Jq(Q)}function tq(){let q=new MutationObserver((J)=>{let K=!1;for(let Q of J){if(Q.addedNodes.length>0){K=!0;for(let G of Q.addedNodes)if(G instanceof Element)E(G)}if(Q.removedNodes.length>0){K=!0;for(let G of Q.removedNodes)if(G instanceof Element){lq(G);for(let Y of G.querySelectorAll("*"))lq(Y)}}if(Q.type==="attributes"&&Q.target instanceof Element){let G=Q.attributeName;if(G?.startsWith("hs-")){if(i.delete(Q.target),Jq(Q.target),G==="hs-ref")K=!0}}}if(K)cq()});return q.observe(document.body,{childList:!0,subtree:!0,attributes:!0}),q}var EJ="morph",gJ="signals",xJ="execute",pJ="redirect",uJ="error",mJ="title",cJ="favicon",N=null,Yq=null,zq=0,Sq=null,dJ=null,c=null,Fq=!1,sJ=10,aJ=1000,rJ=30000;function iJ(q){let J="message",K="",Q,G;for(let Y of q)if(Y.startsWith("event:"))J=Y.slice(6).trim();else if(Y.startsWith("data:")){let D=Y.slice(5);K+=(D.startsWith(" ")?D.slice(1):D)+`
`}else if(Y.startsWith("id:"))Q=Y.slice(3).trim();else if(Y.startsWith("retry:"))G=parseInt(Y.slice(6).trim(),10);if(K.endsWith(`
`))K=K.slice(0,-1);if(!K&&J==="message")return null;return{event:J,data:K,id:Q,retry:G}}async function oJ(q,J){let K=q.getReader(),Q=new TextDecoder,G="",Y=[];while(!0){let{done:D,value:A}=await K.read();if(D)break;G+=Q.decode(A,{stream:!0});let I=G.split(`
`);G=I.pop()||"";for(let H of I)if(H===""){if(Y.length>0){let y=iJ(Y);if(y)J(y);Y=[]}}else Y.push(H)}}function lJ(q){if(q.id)Sq=q.id;if(Fq)return;switch(q.event){case EJ:{try{let J=JSON.parse(q.data);if(J.html)nJ(J.html,J.target)}catch(J){console.error("[hyperstar] Failed to parse morph message:",J)}break}case gJ:{try{let J=JSON.parse(q.data);d(J)}catch(J){console.error("[hyperstar] Failed to parse signals message:",J)}break}case xJ:{try{let J=JSON.parse(q.data);if(J.script)eJ(J.script)}catch(J){console.error("[hyperstar] Failed to parse execute message:",J)}break}case pJ:{try{let J=JSON.parse(q.data);if(J.url)if(J.replace)window.location.replace(J.url);else window.location.href=J.url}catch(J){console.error("[hyperstar] Failed to parse redirect message:",J)}break}case uJ:{try{let J=JSON.parse(q.data);console.error("[hyperstar] Server error:",J.message,J.code)}catch(J){console.error("[hyperstar] Failed to parse error message:",J)}break}case mJ:{try{let J=JSON.parse(q.data);if(J.title)document.title=J.title}catch(J){console.error("[hyperstar] Failed to parse title message:",J)}break}case cJ:{try{let J=JSON.parse(q.data);if(J.href)tJ(J.href,J.type)}catch(J){console.error("[hyperstar] Failed to parse favicon message:",J)}break}default:break}}function nJ(q,J){if(J){let G=document.getElementById(J);if(G){let Y=document.createElement("template");Y.innerHTML=q;let D=Y.content.firstElementChild;if(D)a(G,D),Gq(G),E(G);return}}let K=document.createElement("template");K.innerHTML=q;let Q=K.content;for(let G of Array.from(Q.children)){let Y=G.id;if(Y){let D=document.getElementById(Y);if(D)a(D,G),Gq(D),E(D)}else a(document.body,G,"inner"),Gq(document.body),E(document.body)}}function tJ(q,J="image/x-icon"){let K=document.querySelector("link[rel='icon']");if(!K)K=document.createElement("link"),K.rel="icon",document.head.appendChild(K);K.href=q,K.type=J}function eJ(q){try{Function(q)()}catch(J){console.error("[hyperstar] Script execution error:",J)}}function qK(){return Math.min(aJ*Math.pow(2,zq),rJ)+Math.random()*1000}var o=!1;function JK(q){if(c)document.removeEventListener("visibilitychange",c);c=()=>{if(document.hidden)Fq=!0;else if(Fq=!1,!eq()&&!o)Xq(q)},document.addEventListener("visibilitychange",c)}async function Xq(q="/sse"){if(o||N&&!N.signal.aborted)return;dJ=q,Iq(),JK(q),o=!0,N=new AbortController;try{let J={Accept:"text/event-stream","Cache-Control":"no-cache"};if(Sq)J["Last-Event-ID"]=Sq;let K=await fetch(q,{method:"GET",headers:J,signal:N.signal,credentials:"same-origin"});if(!K.ok)throw Error(`SSE connection failed: ${K.status}`);if(!K.body)throw Error("SSE response has no body");zq=0,o=!1,await oJ(K.body,lJ),Aq(q)}catch(J){o=!1;let K=J;if(K.name==="AbortError"||K.message?.includes("abort")||K.message?.includes("network error")){Aq(q);return}console.error("[hyperstar] SSE connection error:",J),Aq(q)}}function Aq(q){if(zq>=sJ){console.error("[hyperstar] Max reconnect attempts reached");return}zq++;let J=qK();Yq=setTimeout(()=>{Xq(q)},J)}function Iq(){if(o=!1,Fq=!1,Yq)clearTimeout(Yq),Yq=null;if(N)N.abort(),N=null;if(c)document.removeEventListener("visibilitychange",c),c=null}function eq(){return N!==null&&!N.signal.aborted}var Uq=null;function qJ(q){Uq=q}function JJ(){return Uq}async function KK(q){if(q.status===204)return;if((q.headers.get("Content-Type")||"").includes("text/event-stream")){let K=q.body;if(!K)return;let Q=K.getReader(),G=new TextDecoder,Y="",D="",A=[];while(!0){let{done:I,value:H}=await Q.read();if(I)break;Y+=G.decode(H,{stream:!0});let y=Y.split(`
`);Y=y.pop()||"";for(let f of y)if(f.startsWith("event:"))D=f.slice(6).trim();else if(f.startsWith("data:")){let L=f.slice(5);A.push(L.startsWith(" ")?L.slice(1):L)}else if(f===""){if(A.length>0)QK(D,A.join(`
`));D="",A=[]}}}}function QK(q,J){if(q==="signals")try{let K=JSON.parse(J);d(K)}catch(K){console.error("[hyperstar] Failed to parse signals:",K)}}async function Wq(q,J={}){if(!Uq){console.error("[hyperstar] No session ID set - cannot dispatch action");return}let K=Vq();try{let Q=await fetch("/hs/action",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify({sessionId:Uq,actionId:q,args:J,signals:K})});if(!Q.ok){let G=await Q.text();console.error(`[hyperstar] Action failed (${Q.status}):`,G);return}await KK(Q)}catch(Q){console.error("[hyperstar] Action dispatch error:",Q)}}function KJ(q,J){return Wq(q,J)}function QJ(q,J){return Wq(q,J)}function yq(){E(document),tq()}var ZJ={init:yq,connect:Xq,disconnect:Iq,getSignal:w,getValue:Eq,setValue:u,mergeSignals:d,batch:g,dispatch:Wq,mutation:QJ,action:KJ,setSessionId:qJ,getSessionId:JJ,evaluate:mq,execute:r,processTree:E,processElement:Jq,morph:a};if(typeof window<"u")if(window.Hyperstar=ZJ,document.readyState==="loading")document.addEventListener("DOMContentLoaded",yq);else yq();var xK=ZJ;export{tq as setupMutationObserver,u as setValue,qJ as setSessionId,E as processTree,Jq as processElement,_J as parseHTML,DJ as onCleanup,QJ as mutation,a as morph,d as mergeSignals,eq as isConnected,Rq as initSignals,yq as init,Eq as getValue,w as getSignal,JJ as getSessionId,r as execute,mq as evaluate,Wq as dispatch,Iq as disconnect,xK as default,Xq as connect,Vq as collectSignals,OJ as clearAll,g as batch,KJ as action};
